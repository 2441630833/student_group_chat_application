(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-chatroom-chatroom"],{4470:function(t,e,i){t.exports=i.p+"static/img/send.2dc17438.png"},"6547d":function(t,e,i){var s=i("24fb");e=s(!1),e.push([t.i,"/**\r\n * this uni-app's style variables setting\r\n *\r\n * \r\n * \r\n *\r\n */\r\n/* Colour setting */\r\n/* behaviour colour */\r\n/* word basic colour */\r\n/* backgroud colour */\r\n/*  */\r\n/* Font size setting */\r\n/* word size */\r\n/* image size */\r\n/* Border Radius */\r\n/* row spacing */\r\n/* column spacing*/\r\n/* Transparency */\r\n/* article scene */.status-bar[data-v-c5a8c60e]{position:fixed;left:0;width:100%;height:%?88?%;padding-top:0;display:-webkit-box;display:-webkit-flex;display:flex;overflow:hidden;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;z-index:998;color:#272832;-webkit-transition-property:all;transition-property:all;background:hsla(0,0%,100%,.96)}.status-bar .login-c[data-v-c5a8c60e]{width:%?60?%;height:%?60?%;padding-top:%?22?%;padding-left:%?32?%}.status-bar .login-back[data-v-c5a8c60e]{width:%?20?%;height:%?34?%}.status-bar .scrollv[data-v-c5a8c60e]{width:84%}.status-bar .scrollv .users[data-v-c5a8c60e]{display:flex}.status-bar .scrollv .users .user-l[data-v-c5a8c60e]{padding:%?12?% %?8?%;position:relative}.status-bar .scrollv .users .user-l uni-image[data-v-c5a8c60e]{width:%?64?%;height:%?64?%;border-radius:50%}.status-bar .scrollv .users .user-l .tip[data-v-c5a8c60e]{width:%?14?%;height:%?14?%;background:#ff4d3c;position:absolute;top:%?12?%;right:%?10?%;border-radius:50%;z-index:10}.main[data-v-c5a8c60e]{padding:%?160?% %?28?% %?160?%}.main .msg[data-v-c5a8c60e],\r\n.modfiy-mian .msg[data-v-c5a8c60e]{display:flex;align-items:flex-end;padding:%?40?% 0}.main .msg uni-image[data-v-c5a8c60e],\r\n.modfiy-mian .msg uni-image[data-v-c5a8c60e]{flex:none;width:%?64?%;height:%?64?%;border-radius:%?18?%;margin:0 %?20?%}.main .msg .messageOverall .messageContent[data-v-c5a8c60e],\r\n.modfiy-mian .msg .messageOverall .messageContent[data-v-c5a8c60e]{max-width:%?380?%;padding:%?26?% %?32?%;min-height:%?48?%;font-size:%?28?%;color:#191d23;line-height:%?40?%}.main .msg .messageOverall .messageTime[data-v-c5a8c60e],\r\n.modfiy-mian .msg .messageOverall .messageTime[data-v-c5a8c60e]{padding-top:%?8?%;position:absolute;font-size:%?24?%;color:rgba(25,29,35,.5);line-height:%?34?%}.main .left[data-v-c5a8c60e],\r\n.modfiy-mian .left[data-v-c5a8c60e]{flex-direction:row}.main .left .messageContent[data-v-c5a8c60e],\r\n.modfiy-mian .left .messageContent[data-v-c5a8c60e]{background:#f4f4f4;border-radius:%?24?% %?24?% %?24?% 0;overflow:auto;word-wrap:break-word}.main .right[data-v-c5a8c60e],\r\n.modfiy-mian .right[data-v-c5a8c60e]{flex-direction:row-reverse}.main .right .messageContent[data-v-c5a8c60e],\r\n.modfiy-mian .right .messageContent[data-v-c5a8c60e]{background:#c8ffc8;border-radius:%?24?% %?24?% 0 %?24?%;overflow:auto;word-wrap:break-word}.main .right .messageTime[data-v-c5a8c60e],\r\n.modfiy-mian .right .messageTime[data-v-c5a8c60e]{right:%?132?%}.main .center[data-v-c5a8c60e],\r\n.modfiy-mian .center[data-v-c5a8c60e]{text-align:center;padding:%?32?% 0 %?20?%}.main .center .inner[data-v-c5a8c60e],\r\n.modfiy-mian .center .inner[data-v-c5a8c60e]{font-size:%?24?%;display:inline-block;color:rgba(25,29,35,.5);line-height:%?34?%}.send[data-v-c5a8c60e]{position:fixed;z-index:1002;bottom:0;width:100%;padding-bottom:0;min-height:%?100?%;background:hsla(0,0%,100%,.96);display:flex}.send .chat-send[data-v-c5a8c60e]{margin:%?12?% %?48?% %?12?% %?0?%;flex:1;width:100%;min-height:%?40?%;background:#f2f2f2;border-radius:%?24?%;font-size:%?28?%;color:#191d23;line-height:%?40?%;padding:%?24?% %?80?% %?24?% %?24?%}.send .send-img[data-v-c5a8c60e]{width:%?48?%;height:%?48?%;position:absolute;right:%?68?%;top:%?32?%}.send .send-in[data-v-c5a8c60e]{display:flex;width:100%;padding-left:%?48?%}.send .send-in .emoji-img[data-v-c5a8c60e]{width:%?48?%;height:%?48?%;background:#f2f2f2;padding:10px;border-radius:%?24?%;margin:%?12?% %?16?% %?12?% %?0?%}.send .send-in .gpt-img[data-v-c5a8c60e]{width:%?48?%;height:%?48?%;background:#f2f2f2;padding:10px;border-radius:%?24?%;margin:%?12?% %?16?% %?12?% %?0?%}.modify[data-v-c5a8c60e]{position:fixed;overflow:hidden;left:0;bottom:-90%;width:100%;height:90%;z-index:1000;background:#fff;border-radius:%?48?% %?48?% 0 0}.u-name[data-v-c5a8c60e]{position:absolute;top:0;background-color:#fff;height:%?80?%;text-align:center;width:100%;line-height:%?80?%}.modfiy-mian[data-v-c5a8c60e]{padding:%?88?% %?28?% %?120?%;box-sizing:border-box;height:100%}.bg[data-v-c5a8c60e]{width:100%;height:100%;position:fixed;top:0;left:0;z-index:999;background-color:rgba(0,0,0,.4)}.join[data-v-c5a8c60e]{margin-top:%?180?%;width:%?200?%;height:%?200?%;background:#ff833c;box-shadow:0 %?36?% %?68?% %?-8?% rgba(255,131,60,.5);border-radius:50%;font-size:%?28?%;font-weight:600;text-align:center;line-height:%?200?%;color:#fff}.emoji-display[data-v-c5a8c60e]{position:absolute;width:100%;height:210px;background-color:#fff;top:-210px;left:0;overflow-y:auto}.emoji-display ul[data-v-c5a8c60e]{display:flex;flex-wrap:wrap;list-style:none}.emoji-display ul li[data-v-c5a8c60e]{padding:2px 3px;font-size:2.2rem}",""]),t.exports=e},6615:function(t,e,i){t.exports=i.p+"static/img/chatGPT.af91fc9d.png"},7588:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAuCAYAAAA2oQl1AAABm0lEQVRYR7XWO0oDQRjA8e+TRImF4AFMp2FdApqI2CgIWggeQc9gIdp5A7HxCmKt1kKwtNh0CxNYCxFCRLDYgBizuyOr7JLHvmbmmznA/JgX80fQM9A0m0sA3z3btn9CAqmdar2+OD8s33GAHc7hLfBx13GsF1IoRCrD8iMANKIFIOAVY9YpGZSE/G8ZnjFmXZJAaQgAtHzPPXAcZ6AMZSF9Fw+7XetL+TIURZQgEUQaEkWkIBlEGJJFhCAVpDCkihSCKJBciArJhCiRVIgaSYR0IFOQLmQM0onEkG4kgrBWazwBwvZEP7RG/xPVtghrper5/HViItZ3sRl9WqrI34pM05z1/LkPAFgYmZAj4Alj1jUFEp/RsrG2j8HMPSJUdGFxMxjG+p4f4IMubCxOdGJTFaQLS8wtHVhq11FjmQFJieWWKhWWC4XvigIrBFFghSFVTAhSwYQhWUwKksGkIVFMCRLBlKGiGAmUgx0xZt2SQWkYAjwz1t4ihRIxDjedTvuYHAqxldWNTQyCc+DwXioNLmzb/tQCJZXTL8IJez4aufulAAAAAElFTkSuQmCC"},8811:function(t,e,i){t.exports=i.p+"static/img/emoji.eabbd71d.png"},"90ea":function(t,e,i){"use strict";var s=i("9699"),a=i.n(s);a.a},9699:function(t,e,i){var s=i("6547d");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var a=i("4f06").default;a("d9ba3f78",s,!0,{sourceMap:!1,shadowMode:!1})},acf1:function(t,e,i){"use strict";i("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("14d9"),i("a434");var s=i("c4ef"),a={data:function(){return{roomID:"",chatm:"",name:"",uname:"",id:"",friendID:"",userID:"a",friendID2:"",userID2:"",img:"",chat:[],member:0,animationData:{},bb:!1,bg:"none",users:"",otochat:[],groupChatMessages:[],singlechat:[],emojis:["😂","🙏","😄","😏","😇","😅","😌","😘","😍","🤓","😜","😎","😊","😳","🙄","😱","😒","😔","😷","👿","🤗","😩","😤","😣","😰","😴","😬","😭","👻","👍","✌️","👉","👀","🐶","🐷","😹","⚡️","🔥","🌈","🍏","⚽️","❤️"],isShowEmoji:!1,scrollHeight:0}},computed:{},onLoad:function(t){this.name=t.name,this.img=t.img,this.id=t.id,this.roomID=t.roomID,this.join(this.name,this.img,this.id,this.roomID),this.welcome(),this.myself(),this.receiveGroupMsg(),this.receiveAIMsg(),this.receiveSingleMsg(),this.quit(),this.fetchGroupChatMessages(),this.fetchSingleChatMessages()},methods:{myselfMessageScroll:function(){this.$nextTick((function(){uni.pageScrollTo({scrollTop:1e16,duration:0})}))},inputDialogToggle:function(){var t=this;uni.request({url:s.BASE_URL+":"+s.SERVER_PORT+"/membershipVerify",method:"GET",data:{id:this.id},success:function(e){200===e.statusCode?uni.navigateTo({url:"../upload/upload?roomID="+t.roomID}):400===e.statusCode||404===e.statusCode?uni.showToast({title:e.data.message,icon:"none"}):t.$refs.inputDialog.open()},fail:function(t){console.log(t)}})},scrollToBottom:function(){this.$nextTick((function(){uni.pageScrollTo({scrollTop:1e16,duration:100})}))},singleChatScrollToBottom:function(){var t=this;this.$nextTick((function(){t.scrollHeight+=200}))},singleChatInitializeToBottom:function(){var t=this;this.$nextTick((function(){t.scrollHeight+=2e7}))},insertText:function(t){this.chatm+=t,this.isShowEmoji=!1},showEmoji:function(t){this.isShowEmoji=!t},gptUpload:function(t){var e=this;uni.request({url:s.BASE_URL+":"+s.SERVER_PORT+"/gptVerify",method:"POST",data:{id:this.id,key:t},success:function(t){200===t.statusCode?uni.navigateTo({url:"../upload/upload?roomID="+e.roomID}):uni.showToast({title:t.data.message,icon:"none"})},fail:function(t){console.log(t)}})},quitRoom:function(){this.socket.emit("quitRoom",{id:this.id,name:this.name,roomID:this.roomID}),this.socket.emit("updateTipStatus",this.roomID)},disconnect:function(){this.socket.disconnect()},timeProcess:function(t){var e,i=new Date(t),s=new Date,a=(i.getTime(),i.getHours()),n=i.getMinutes(),o=i.getFullYear(),r=i.getMonth()+1,c=i.getDate(),u=(s.getTime(),s.getHours(),s.getMinutes(),s.getFullYear()),l=s.getMonth()+1,d=s.getDate();return c==d&&r==l&&o==u?(a<10&&(a="0"+a),n<10&&(n="0"+n),e=a+":"+n,e):c+1==d&&r==l&&o==u?(a<10&&(a="0"+a),n<10&&(n="0"+n),e="yesterday "+a+":"+n,e):(r<10&&(r="0"+r),c<10&&(c="0"+c),a<10&&(a="0"+a),n<10&&(n="0"+n),e=o+"/"+r+"/"+c+" "+a+":"+n,e)},sendMsg:function(){if(this.chatm.length>0&&""==this.friendID){var t={roomID:this.roomID,messageContent:this.chatm,img:this.img,time:new Date,id:2,senderID:this.id},e={roomID:this.roomID,messageContent:this.chatm,img:this.img,name:this.name,time:new Date,id:1,senderID:this.id};this.groupChatMessages.push(t),this.chatm="",this.socket.emit("message",e),this.saveChatToDB(e,"/groupchat"),this.scrollToBottom()}else if(this.chatm.length>0&&""!=this.friendID){var i={roomID:this.roomID,messageContent:this.chatm,img:this.img,time:new Date,fromID:this.userID,toID:this.friendID,fromID2:this.userID2,toID2:this.friendID2},s={roomID:this.roomID,messageContent:this.chatm,img:this.img,name:this.name,time:new Date,fromID:this.userID,toID:this.friendID,fromID2:this.userID2,toID2:this.friendID2};this.singlechat.push(i),this.chatm="",this.socket.emit("msg",s),this.saveChatToDB(s,"/singlechat"),this.singleChatScrollToBottom()}},saveChatToDB:function(t,e){uni.request({url:s.BASE_URL+":"+s.SERVER_PORT+e,data:t,method:"POST",success:function(t){t.statusCode},fail:function(t){console.error("Failed to save chat data: "+t)}})},join:function(t,e,i,s){this.socket.emit("join",t,e,i,s)},welcome:function(){var t=this;this.socket.on("welcome",(function(e,i){var s={name:"welcome "+e+" join the group chat",id:3};t.groupChatMessages.push(s);for(var a=0;a<i.length;a++)i[a].id==t.userID&&i.splice(a,1);t.users=i,t.scrollToBottom()}))},myself:function(){var t=this;this.socket.on("myself",(function(e,i,s,a){t.userID=s,t.userID2=a;var n={name:"welcome "+e+" join the group chat",id:3};t.groupChatMessages.push(n);for(var o=0;o<i.length;o++)i[o].id==t.userID&&i.splice(o,1);t.users=i,t.myselfMessageScroll()}))},quit:function(){var t=this;this.socket.on("quit",(function(e){var i={name:e.name+" quit the group chat",id:3};t.groupChatMessages.push(i),t.scrollToBottom(),t.users=e.users}))},receiveGroupMsg:function(){var t=this;this.socket.on("sendMsg",(function(e){t.groupChatMessages.push(e),t.scrollToBottom()}))},receiveAIMsg:function(){var t=this;this.socket.on("sumbitAIMsg",(function(e){t.groupChatMessages.push(e),t.scrollToBottom()}))},receiveSingleMsg:function(){var t=this;this.socket.on("sMsg",(function(e){var i=e.fromID;if(t.friendID!=i)for(var s=0;s<t.users.length;s++)t.users[s].id==i&&(t.users[s].tip=!0);t.singlechat.push(e),t.singleChatScrollToBottom()}))},singleChat:function(t){this.uname=this.users[t].name,this.friendID=this.users[t].id,this.friendID2=this.users[t].userID2,this.users[t].tip=!1,this.modify(),this.singleChatInitializeToBottom()},outSingleChat:function(){this.uname="",this.friendID="",this.friendID2="",this.modify()},modify:function(){this.bb=!this.bb,this.bb?this.bg="block":this.bg="none";var t=uni.createAnimation({duration:400,timingFunction:"ease"});this.animation=t,this.bb?t.bottom(0).step():t.bottom().step(),this.animationData=t.export()},fetchGroupChatMessages:function(){var t=this;uni.request({url:s.BASE_URL+":"+s.SERVER_PORT+"/groupchat?roomID=".concat(this.roomID),method:"GET",success:function(e){t.groupChatMessages=e.data},fail:function(t){console.error("Error fetching group chat messages:",t)}})},fetchSingleChatMessages:function(){var t=this;uni.request({url:s.BASE_URL+":"+s.SERVER_PORT+"/singlechat?roomID=".concat(this.roomID),method:"GET",success:function(e){t.singlechat=e.data},fail:function(t){console.error("Error fetching group chat messages:",t)}})}}};e.default=a},d2e7:function(t,e,i){"use strict";i.r(e);var s=i("acf1"),a=i.n(s);for(var n in s)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(n);e["default"]=a.a},dbc2:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return s}));var s={uniPopup:i("4b2d").default,uniPopupDialog:i("5f7b").default},a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-uni-view",[s("v-uni-view",{staticClass:"status-bar"},[s("v-uni-navigator",{staticClass:"login-c",attrs:{"open-type":"navigateBack","hover-class":"none"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.quitRoom.apply(void 0,arguments)}}},[s("v-uni-image",{staticClass:"login-back",attrs:{src:i("7588")}})],1),s("v-uni-scroll-view",{staticClass:"scrollv",attrs:{"scroll-x":"true"}},[s("v-uni-view",{staticClass:"users"},t._l(t.users,(function(e,i){return e.roomID==t.roomID?s("v-uni-view",{staticClass:"user-l",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.singleChat(i)}}},[e.tip?s("v-uni-view",{staticClass:"tip"}):t._e(),s("v-uni-image",{attrs:{src:"../../static/images/"+e.img+".png"}})],1):t._e()})),1)],1)],1),s("v-uni-view",{staticClass:"main"},t._l(t.groupChatMessages,(function(e,a){return s("v-uni-view",{key:a},[1==e.id&&e.senderID!=t.id?s("v-uni-view",{staticClass:"left msg"},[s("v-uni-image",{attrs:{src:"../../static/images/"+e.img+".png"}}),s("v-uni-view",{staticClass:"messageOverall"},[s("v-uni-view",{staticClass:"messageContent"},[t._v(t._s(e.messageContent))]),s("v-uni-view",{staticClass:"messageTime"},[t._v(t._s(e.name)+" "+t._s(t.timeProcess(e.time)))])],1)],1):t._e(),2==e.id||e.senderID==t.id?s("v-uni-view",{staticClass:"right msg"},[s("v-uni-image",{attrs:{src:"../../static/images/"+e.img+".png"}}),s("v-uni-view",{staticClass:"messageOverall"},[s("v-uni-view",{staticClass:"messageContent"},[t._v(t._s(e.messageContent))]),s("v-uni-view",{staticClass:"messageTime"},[t._v(t._s(t.timeProcess(e.time)))])],1)],1):t._e(),3==e.id?s("v-uni-view",{staticClass:"center"},[s("v-uni-view",{staticClass:"inner"},[t._v(t._s(e.name))])],1):t._e(),4==e.id?s("v-uni-view",{staticClass:"left msg"},[s("v-uni-image",{attrs:{src:i("6615")}}),s("v-uni-view",{staticClass:"messageOverall"},[s("v-uni-view",{staticClass:"messageContent"},[t._v(t._s(e.messageContent))]),s("v-uni-view",{staticClass:"messageTime"},[t._v(t._s(t.timeProcess(e.time)))])],1)],1):t._e()],1)})),1),s("v-uni-view",{staticClass:"send"},[s("v-uni-view",{staticClass:"send-in"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowEmoji,expression:"isShowEmoji"}],staticClass:"emoji-display"},[s("ul",t._l(t.emojis,(function(e){return s("li",{on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.insertText(e)}}},[t._v(t._s(e))])})),0)]),s("v-uni-image",{staticClass:"emoji-img",attrs:{src:i("8811"),mode:"aspectFit"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.showEmoji(t.isShowEmoji)}}}),t.friendID?t._e():s("v-uni-image",{staticClass:"gpt-img",attrs:{src:i("6615"),mode:"aspectFit"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.inputDialogToggle.apply(void 0,arguments)}}}),s("v-uni-textarea",{staticClass:"chat-send",attrs:{type:"text","confirm-type":"send","auto-height":"true","show-confirm-bar":"false",maxlength:"-1"},on:{keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;arguments[0]=e=t.$handleEvent(e),t.sendMsg.apply(void 0,arguments)}},model:{value:t.chatm,callback:function(e){t.chatm=e},expression:"chatm"}})],1),s("v-uni-image",{staticClass:"send-img",attrs:{src:i("4470"),mode:"aspectFit"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.sendMsg.apply(void 0,arguments)}}})],1),s("v-uni-view",{staticClass:"modify",attrs:{animation:t.animationData}},[s("v-uni-view",{staticClass:"u-name"},[t._v(t._s(t.uname))]),s("v-uni-scroll-view",{staticClass:"modfiy-mian",attrs:{"scroll-y":"true","scroll-top":t.scrollHeight}},t._l(t.singlechat,(function(e,i){return s("v-uni-view",{key:i},[e.fromID!=t.friendID&&e.fromID2!=t.friendID2||e.fromID2==e.toID2?t._e():s("v-uni-view",{staticClass:"left msg"},[s("v-uni-image",{attrs:{src:"../../static/images/"+e.img+".png"}}),s("v-uni-view",{staticClass:"messageOverall"},[s("v-uni-view",{staticClass:"messageContent"},[t._v(t._s(e.messageContent))]),s("v-uni-view",{staticClass:"messageTime"},[t._v(t._s(t.timeProcess(e.time)))])],1)],1),e.fromID==t.userID&&e.toID==t.friendID||e.fromID2==t.userID2&&e.toID2==t.friendID2?s("v-uni-view",{staticClass:"right msg"},[s("v-uni-image",{attrs:{src:"../../static/images/"+e.img+".png"}}),s("v-uni-view",{staticClass:"messageOverall"},[s("v-uni-view",{staticClass:"messageContent"},[t._v(t._s(e.messageContent))]),s("v-uni-view",{staticClass:"messageTime"},[t._v(t._s(t.timeProcess(e.time)))])],1)],1):t._e()],1)})),1)],1),s("v-uni-view",{staticClass:"bg",style:{display:t.bg},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.outSingleChat.apply(void 0,arguments)}}}),s("uni-popup",{ref:"inputDialog",attrs:{type:"dialog"}},[s("uni-popup-dialog",{ref:"inputClose",attrs:{mode:"input",title:"Encryption key",value:"",placeholder:"please input the encryption key"},on:{confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.gptUpload.apply(void 0,arguments)}}})],1)],1)},n=[]},e0e3:function(t,e,i){"use strict";i.r(e);var s=i("dbc2"),a=i("d2e7");for(var n in a)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(n);i("90ea");var o=i("f0c5"),r=Object(o["a"])(a["default"],s["b"],s["c"],!1,null,"c5a8c60e",null,!1,s["a"],void 0);e["default"]=r.exports}}]);